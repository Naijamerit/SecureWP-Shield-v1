# Nginx server block security snippets (include where appropriate)


# Basic security headers
add_header X-Frame-Options "DENY" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "no-referrer-when-downgrade" always;
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval';";


# Deny access to sensitive files
location ~* /(wp-config.php|readme.html|license.txt|error_log)$ {
deny all;
return 404;
}


# Disable PHP execution in uploads
location ^~ /wp-content/uploads/ {
location ~* \.php$ { deny all; }
try_files $uri $uri/ =404;
}


# Block xmlrpc.php unless explicitly allowed
location = /xmlrpc.php {
deny all;
return 403;
}


# Force HTTPS redirect (if not handled by load balancer)
server {
listen 80;
server_name example.com www.example.com;
return 301 https://$host$request_uri;
}

# Basic .htaccess security rules for Apache + mod_rewrite


# Prevent directory listing
Options -Indexes


# Protect wp-config.php
<files wp-config.php>
order allow,deny
deny from all
</files>


# Disable PHP execution in uploads
<Directory "/var/www/html/wp-content/uploads">
<FilesMatch "\.(php|phtml)$">
Order allow,deny
Deny from all
</FilesMatch>
</Directory>


# Security headers
<IfModule mod_headers.c>
Header set X-Frame-Options "DENY"
Header set X-Content-Type-Options "nosniff"
Header set X-XSS-Protection "1; mode=block"
Header set Referrer-Policy "no-referrer-when-downgrade"
Header set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
# Basic CSP - tailor for your assets
Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval';"
</IfModule>


# Force HTTPS (if using Apache)
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>


# Block access to xmlrpc.php unless needed
<Files "xmlrpc.php">
Order Deny,Allow
Deny from all
# Allow from specific IPs if needed
# Allow from 1.2.3.4
</Files>


# Protect .htaccess itself
<Files ".htaccess">
Order allow,deny
Deny from all
</Files>
